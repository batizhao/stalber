<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.2.xsd">

    <changeSet author="batizhao" id="CreateTableDepartment-20210422-001">
        <addColumn tableName="user">
            <column name="uuid" type="varchar(36)" remarks="第三方ID" valueComputed="${uuid}">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <createTable remarks="部门表" tableName="department">
            <column autoIncrement="true" name="id" type="BIGINT" remarks="部门ID">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="uuid" type="varchar(36)" remarks="第三方ID" valueComputed="${uuid}">
                <constraints nullable="false" />
            </column>
            <column name="pid" type="BIGINT" remarks="父ID">
                <constraints nullable="false" />
            </column>
            <column name="name" type="VARCHAR(64)" remarks="名称">
                <constraints nullable="false" />
            </column>
            <column name="fullName" type="VARCHAR(255)" remarks="全名">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="sort" type="INT" remarks="排序" defaultValue="1">
                <constraints nullable="false" />
            </column>
            <column name="status" type="VARCHAR(32)" remarks="状态" defaultValue="open">
                <constraints nullable="false" />
            </column>
            <column name="createTime" type="datetime" remarks="创建时间" defaultValueComputed="NOW()">
                <constraints nullable="false"/>
            </column>
            <column name="updateTime" type="datetime" remarks="修改时间" defaultValueComputed="NOW() ON UPDATE NOW()">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="department"/>
        </rollback>
        <createTable remarks="岗位表" tableName="post">
            <column autoIncrement="true" name="id" type="BIGINT" remarks="岗位ID">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="name" type="VARCHAR(64)" remarks="名称">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="code" type="VARCHAR(64)" remarks="编码">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="sort" type="INT" remarks="排序" defaultValue="1">
                <constraints nullable="false" />
            </column>
            <column name="status" type="VARCHAR(32)" remarks="状态" defaultValue="open">
                <constraints nullable="false" />
            </column>
            <column name="createTime" type="datetime" remarks="创建时间" defaultValueComputed="NOW()">
                <constraints nullable="false"/>
            </column>
            <column name="updateTime" type="datetime" remarks="修改时间" defaultValueComputed="NOW() ON UPDATE NOW()">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="post"/>
        </rollback>
        <createTable tableName="user_department" remarks="用户部门关联">
            <column name="userId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_DEPARTMENT"/>
            </column>
            <column name="departmentId" type="BIGINT" remarks="部门ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_DEPARTMENT"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="user_department"/>
        </rollback>
        <createTable tableName="user_post" remarks="用户岗位关联">
            <column name="userId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_POST"/>
            </column>
            <column name="postId" type="BIGINT" remarks="岗位ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_POST"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="user_post"/>
        </rollback>
        <createTable tableName="department_leader" remarks="部门领导关联">
            <column name="departmentId" type="BIGINT" remarks="部门ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DEPARTMENT_LEADER"/>
            </column>
            <column name="leaderUserId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DEPARTMENT_LEADER"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="department_leader"/>
        </rollback>
    </changeSet>
</databaseChangeLog>