<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.2.xsd">

    <changeSet author="batizhao" id="CreateTableDepartment-20210422-001">
        <addColumn tableName="user">
            <column name="uuid" type="varchar(36)" remarks="第三方ID" valueComputed="${uuid}">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <createTable remarks="部门表" tableName="department">
            <column autoIncrement="true" name="id" type="BIGINT" remarks="部门ID">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="uuid" type="varchar(36)" remarks="第三方ID" valueComputed="${uuid}">
                <constraints nullable="false" />
            </column>
            <column name="pid" type="BIGINT" remarks="父ID">
                <constraints nullable="false" />
            </column>
            <column name="name" type="VARCHAR(64)" remarks="名称">
                <constraints nullable="false" />
            </column>
            <column name="fullName" type="VARCHAR(255)" remarks="全名">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="sort" type="INT" remarks="排序" defaultValue="1">
                <constraints nullable="false" />
            </column>
            <column name="status" type="VARCHAR(32)" remarks="状态" defaultValue="open">
                <constraints nullable="false" />
            </column>
            <column name="createTime" type="datetime" remarks="创建时间" defaultValueComputed="NOW()">
                <constraints nullable="false"/>
            </column>
            <column name="updateTime" type="datetime" remarks="修改时间" defaultValueComputed="NOW() ON UPDATE NOW()">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="department"/>
        </rollback>
        <createTable remarks="岗位表" tableName="post">
            <column autoIncrement="true" name="id" type="BIGINT" remarks="岗位ID">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="name" type="VARCHAR(64)" remarks="名称">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="code" type="VARCHAR(64)" remarks="编码">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="sort" type="INT" remarks="排序" defaultValue="1">
                <constraints nullable="false" />
            </column>
            <column name="status" type="VARCHAR(32)" remarks="状态" defaultValue="open">
                <constraints nullable="false" />
            </column>
            <column name="createTime" type="datetime" remarks="创建时间" defaultValueComputed="NOW()">
                <constraints nullable="false"/>
            </column>
            <column name="updateTime" type="datetime" remarks="修改时间" defaultValueComputed="NOW() ON UPDATE NOW()">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="post"/>
        </rollback>
        <createTable tableName="user_department" remarks="用户部门关联">
            <column name="userId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_DEPARTMENT"/>
            </column>
            <column name="departmentId" type="BIGINT" remarks="部门ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_DEPARTMENT"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="user_department"/>
        </rollback>
        <createTable tableName="user_post" remarks="用户岗位关联">
            <column name="userId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_POST"/>
            </column>
            <column name="postId" type="BIGINT" remarks="岗位ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_POST"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="user_post"/>
        </rollback>
        <createTable tableName="department_leader" remarks="部门领导关联">
            <column name="departmentId" type="BIGINT" remarks="部门ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DEPARTMENT_LEADER"/>
            </column>
            <column name="leaderUserId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DEPARTMENT_LEADER"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="department_leader"/>
        </rollback>
    </changeSet>

    <changeSet author="batizhao" id="InsertTableMenu-20210422-002">
        <insert tableName="menu">
            <column name="id" valueNumeric="1400"/>
            <column name="path" value="/ims/post"/>
            <column name="name" value="岗位管理"/>
            <column name="permission" value="ims:post:admin"/>
            <column name="icon" value="post"/>
            <column name="pid" valueNumeric="1000"/>
            <column name="sort" valueNumeric="4"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1401"/>
            <column name="name" value="添加岗位"/>
            <column name="permission" value="ims:post:add"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1400"/>
            <column name="sort" valueNumeric="1"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1402"/>
            <column name="name" value="编辑岗位"/>
            <column name="permission" value="ims:post:edit"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1400"/>
            <column name="sort" valueNumeric="2"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1403"/>
            <column name="name" value="删除岗位"/>
            <column name="permission" value="ims:post:delete"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1400"/>
            <column name="sort" valueNumeric="3"/>
        </insert>
        <rollback>
            delete from menu where id = 1400;
            delete from menu where id = 1401;
            delete from menu where id = 1402;
            delete from menu where id = 1403;
        </rollback>
    </changeSet>

    <changeSet author="batizhao" id="InsertTableRoleMenu-20210422-003">
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1400"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1401"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1402"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1403"/>
        </insert>
        <rollback>
            delete from role_menu where roleId = 2 and menuId = 1400;
            delete from role_menu where roleId = 2 and menuId = 1401;
            delete from role_menu where roleId = 2 and menuId = 1402;
            delete from role_menu where roleId = 2 and menuId = 1403;
        </rollback>
    </changeSet>

    <changeSet author="batizhao" id="CreateTableDepartment-20210422-001">
        <addColumn tableName="user">
            <column name="uuid" type="varchar(36)" remarks="第三方ID" valueComputed="${uuid}">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <createTable remarks="部门表" tableName="department">
            <column autoIncrement="true" name="id" type="BIGINT" remarks="部门ID">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="uuid" type="varchar(36)" remarks="第三方ID" valueComputed="${uuid}">
                <constraints nullable="false" />
            </column>
            <column name="pid" type="BIGINT" remarks="父ID">
                <constraints nullable="false" />
            </column>
            <column name="name" type="VARCHAR(64)" remarks="名称">
                <constraints nullable="false" />
            </column>
            <column name="fullName" type="VARCHAR(255)" remarks="全名">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="sort" type="INT" remarks="排序" defaultValue="1">
                <constraints nullable="false" />
            </column>
            <column name="status" type="VARCHAR(32)" remarks="状态" defaultValue="open">
                <constraints nullable="false" />
            </column>
            <column name="createTime" type="datetime" remarks="创建时间" defaultValueComputed="NOW()">
                <constraints nullable="false"/>
            </column>
            <column name="updateTime" type="datetime" remarks="修改时间" defaultValueComputed="NOW() ON UPDATE NOW()">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="department"/>
        </rollback>
        <createTable remarks="岗位表" tableName="post">
            <column autoIncrement="true" name="id" type="BIGINT" remarks="岗位ID">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="name" type="VARCHAR(64)" remarks="名称">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="code" type="VARCHAR(64)" remarks="编码">
                <constraints nullable="false" unique="true" />
            </column>
            <column name="sort" type="INT" remarks="排序" defaultValue="1">
                <constraints nullable="false" />
            </column>
            <column name="status" type="VARCHAR(32)" remarks="状态" defaultValue="open">
                <constraints nullable="false" />
            </column>
            <column name="createTime" type="datetime" remarks="创建时间" defaultValueComputed="NOW()">
                <constraints nullable="false"/>
            </column>
            <column name="updateTime" type="datetime" remarks="修改时间" defaultValueComputed="NOW() ON UPDATE NOW()">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="post"/>
        </rollback>
        <createTable tableName="user_department" remarks="用户部门关联">
            <column name="userId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_DEPARTMENT"/>
            </column>
            <column name="departmentId" type="BIGINT" remarks="部门ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_DEPARTMENT"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="user_department"/>
        </rollback>
        <createTable tableName="user_post" remarks="用户岗位关联">
            <column name="userId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_POST"/>
            </column>
            <column name="postId" type="BIGINT" remarks="岗位ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_USER_POST"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="user_post"/>
        </rollback>
        <createTable tableName="department_leader" remarks="部门领导关联">
            <column name="departmentId" type="BIGINT" remarks="部门ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DEPARTMENT_LEADER"/>
            </column>
            <column name="leaderUserId" type="BIGINT" remarks="用户ID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DEPARTMENT_LEADER"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="department_leader"/>
        </rollback>
    </changeSet>

    <changeSet author="batizhao" id="InsertTableMenu-20210422-002">
        <insert tableName="menu">
            <column name="id" valueNumeric="1400"/>
            <column name="path" value="/ims/post"/>
            <column name="name" value="岗位管理"/>
            <column name="permission" value="ims:post:admin"/>
            <column name="icon" value="post"/>
            <column name="pid" valueNumeric="1000"/>
            <column name="sort" valueNumeric="4"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1401"/>
            <column name="name" value="添加岗位"/>
            <column name="permission" value="ims:post:add"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1400"/>
            <column name="sort" valueNumeric="1"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1402"/>
            <column name="name" value="编辑岗位"/>
            <column name="permission" value="ims:post:edit"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1400"/>
            <column name="sort" valueNumeric="2"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1403"/>
            <column name="name" value="删除岗位"/>
            <column name="permission" value="ims:post:delete"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1400"/>
            <column name="sort" valueNumeric="3"/>
        </insert>
        <rollback>
            delete from menu where id = 1400;
            delete from menu where id = 1401;
            delete from menu where id = 1402;
            delete from menu where id = 1403;
        </rollback>
    </changeSet>

    <changeSet author="batizhao" id="InsertTableRoleMenu-20210422-003">
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1400"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1401"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1402"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1403"/>
        </insert>
        <rollback>
            delete from role_menu where roleId = 2 and menuId = 1400;
            delete from role_menu where roleId = 2 and menuId = 1401;
            delete from role_menu where roleId = 2 and menuId = 1402;
            delete from role_menu where roleId = 2 and menuId = 1403;
        </rollback>
    </changeSet>

    <changeSet author="batizhao" id="InsertTableMenu-20210425-001">
        <insert tableName="menu">
            <column name="id" valueNumeric="1500"/>
            <column name="path" value="/ims/department"/>
            <column name="name" value="部门管理"/>
            <column name="permission" value="ims:department:admin"/>
            <column name="icon" value="post"/>
            <column name="pid" valueNumeric="1000"/>
            <column name="sort" valueNumeric="5"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1501"/>
            <column name="name" value="添加部门"/>
            <column name="permission" value="ims:department:add"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1500"/>
            <column name="sort" valueNumeric="1"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1502"/>
            <column name="name" value="编辑部门"/>
            <column name="permission" value="ims:department:edit"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1500"/>
            <column name="sort" valueNumeric="2"/>
        </insert>
        <insert tableName="menu">
            <column name="id" valueNumeric="1503"/>
            <column name="name" value="删除部门"/>
            <column name="permission" value="ims:department:delete"/>
            <column name="type" value="B"/>
            <column name="pid" valueNumeric="1500"/>
            <column name="sort" valueNumeric="3"/>
        </insert>
        <rollback>
            delete from menu where id = 1500;
            delete from menu where id = 1501;
            delete from menu where id = 1502;
            delete from menu where id = 1503;
        </rollback>
    </changeSet>
    <changeSet author="batizhao" id="InsertTableRoleMenu-20210425-002">
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1500"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1501"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1502"/>
        </insert>
        <insert tableName="role_menu">
            <column name="roleId" valueNumeric="2"/>
            <column name="menuId" valueNumeric="1503"/>
        </insert>
        <rollback>
            delete from role_menu where roleId = 2 and menuId = 1500;
            delete from role_menu where roleId = 2 and menuId = 1501;
            delete from role_menu where roleId = 2 and menuId = 1502;
            delete from role_menu where roleId = 2 and menuId = 1503;
        </rollback>
    </changeSet>

    <changeSet author="batizhao" id="InsertTableDepartment-20210425-003">
        <insert tableName="department">
            <column name="id" valueNumeric="1"/>
            <column name="pid" valueNumeric="0"/>
            <column name="uuid" value="5fa11b2d-7ed3-4413-8abd-208fdfff0bda"/>
            <column name="name" value="根部门"/>
            <column name="fullName" value="根部门"/>
            <column name="sort" valueNumeric="0"/>
        </insert>
        <rollback>
            delete from department where id = 1;
        </rollback>
    </changeSet>

</databaseChangeLog>